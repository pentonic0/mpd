<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>StreamFlow Player</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="https://content.jwplatform.com/libraries/SAHhwvZq.js"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700&display=swap" rel="stylesheet">
  <style>
    :root {
      --gradient-start: #6dd5ed;
      --gradient-mid: #2193b0;
      --gradient-end: #007bff;
      --header-bg: rgba(0, 0, 0, 0.7);
      --text-color-light: #f0f0f0;
      --server-button-bg: rgba(255, 255, 255, 0.15);
      --server-button-hover: rgba(255, 255, 255, 0.25);
      --server-button-active: rgba(138, 255, 138, 0.3);
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Montserrat', sans-serif;
      background: linear-gradient(135deg, var(--gradient-start), var(--gradient-mid), var(--gradient-end));
      background-size: 400% 400%;
      animation: backgroundGradient 15s ease infinite;
      color: var(--text-color-light);
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      overflow-x: hidden;
    }

    @keyframes backgroundGradient {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }

    header {
      background: var(--header-bg);
      padding: 20px;
      text-align: center;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
      z-index: 10;
    }

    header h1 {
      font-size: 2.5rem;
      font-weight: 700;
      margin-bottom: 8px;
      text-shadow: 0 3px 6px rgba(0, 0, 0, 0.2);
    }

    header p {
      font-size: 1rem;
      opacity: 0.9;
      max-width: 600px;
      margin: 0 auto;
      line-height: 1.5;
    }

    .main-container {
      flex: 1;
      display: flex;
      flex-direction: column;
      padding: 20px;
      gap: 20px;
      max-width: 1200px;
      margin: 0 auto;
      width: 100%;
    }

    #player-container {
      width: 100%;
      height: 0;
      padding-bottom: 56.25%; /* 16:9 aspect ratio */
      position: relative;
      background-color: #000;
      border-radius: 12px;
      overflow: hidden;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
    }

    #player-container .jwplayer {
      position: absolute !important;
      width: 100% !important;
      height: 100% !important;
      top: 0;
      left: 0;
    }

    .servers-section {
      background: rgba(255, 255, 255, 0.1);
      backdrop-filter: blur(10px);
      border-radius: 12px;
      padding: 20px;
      box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2);
    }

    .servers-section h2 {
      font-size: 1.5rem;
      margin-bottom: 15px;
      text-align: center;
      font-weight: 600;
    }

    .servers-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
      gap: 15px;
    }

    .server-button {
      background: var(--server-button-bg);
      color: var(--text-color-light);
      border: 1px solid rgba(255, 255, 255, 0.2);
      border-radius: 10px;
      padding: 15px;
      cursor: pointer;
      font-size: 1rem;
      font-weight: 600;
      transition: all 0.3s ease;
      text-align: center;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 8px;
    }

    .server-button:hover {
      background: var(--server-button-hover);
      transform: translateY(-3px);
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
    }

    .server-button.active {
      background: var(--server-button-active);
      border-color: #8aff8a;
      box-shadow: 0 0 12px rgba(138, 255, 138, 0.5);
    }

    .server-icon {
      font-size: 1.5rem;
    }

    .server-info {
      font-size: 0.85rem;
      opacity: 0.8;
      font-weight: 400;
    }

    .quality-indicator {
      display: flex;
      align-items: center;
      gap: 5px;
      font-size: 0.8rem;
    }

    .quality-dot {
      width: 8px;
      height: 8px;
      border-radius: 50%;
    }

    .quality-high {
      background: #4CAF50;
    }

    .quality-medium {
      background: #FFC107;
    }

    .quality-low {
      background: #F44336;
    }

    footer {
      text-align: center;
      padding: 15px;
      background: rgba(0, 0, 0, 0.5);
      margin-top: 20px;
      font-size: 0.9rem;
      opacity: 0.8;
    }

    /* Responsive adjustments */
    @media (max-width: 768px) {
      header h1 {
        font-size: 2rem;
      }
      
      .servers-grid {
        grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
      }
      
      .main-container {
        padding: 15px;
        gap: 15px;
      }
    }

    @media (max-width: 480px) {
      header h1 {
        font-size: 1.7rem;
      }
      
      header p {
        font-size: 0.9rem;
      }
      
      .servers-grid {
        grid-template-columns: 1fr 1fr;
      }
    }
  </style>
</head>

<body>
  <header>
    <h1>StreamFlow Player</h1>
    <p>Select a server below to start streaming your favorite content</p>
  </header>

  <div class="main-container">
    <div id="player-container"></div>

    <div class="servers-section">
      <h2>Available Streaming Servers</h2>
      <div class="servers-grid" id="servers-grid">
        <!-- Server buttons will be generated by JavaScript -->
      </div>
    </div>
  </div>

  <footer>
    <p>StreamFlow Player &copy; 2023 | Powered by JW Player</p>
  </footer>

  <script type="text/javascript">
    // Predefined servers with URLs and optional DRM keys
    const predefinedServers = [
      {
        name: "Main Server",
        url: "https://cdn.jwplayer.com/manifests/pZxWPRg4.m3u8",
        keyId: "",
        key: "",
        quality: "high",
        location: "US East",
        icon: "ðŸ“º"
      },
      {
        name: "Backup Server",
        url: "https://bitdash-a.akamaihd.net/content/sintel/hls/playlist.m3u8",
        keyId: "",
        key: "",
        quality: "high",
        location: "Europe",
        icon: "ðŸ”„"
      },
      {
        name: "Sports Stream",
        url: "https://test-streams.mux.dev/x36xhzz/x36xhzz.m3u8",
        keyId: "",
        key: "",
        quality: "medium",
        location: "Global",
        icon: "âš½"
      },
      {
        name: "Movie Server",
        url: "https://multiplatform-f.akamaihd.net/i/multi/will/bunny/big_buck_bunny_,640x360_400,640x360_700,640x360_1000,950x540_1500,.f4v.csmil/master.m3u8",
        keyId: "",
        key: "",
        quality: "high",
        location: "US West",
        icon: "ðŸŽ¬"
      },
      {
        name: "Documentary Server",
        url: "https://cph-p2p-msl.akamaized.net/hls/live/2000341/test/master.m3u8",
        keyId: "",
        key: "",
        quality: "medium",
        location: "Asia",
        icon: "ðŸŒ"
      },
      {
        name: "Music Stream",
        url: "https://content.jwplayer.com/manifests/vM7nH0Kl.m3u8",
        keyId: "",
        key: "",
        quality: "high",
        location: "Global",
        icon: "ðŸŽµ"
      },
      {
        name: "Sports",
        url: "https://live.shoq.com.pk/live/eds/ICC_Women_World_Cup_2025/DASH/ICC_Women_World_Cup_2025.mpd",
        keyId: "a6dfc4f17d70d8d07639659193f03b25",
        key: "893eacfabe386144b81733d622a7ad17",
        quality: "high",
        location: "Global",
        icon: "ðŸŽµ"
      }

      
    ];

    let currentPlayer = null;
    let currentServerIndex = -1;

    /**
     * Waits for the JWPlayer library to be loaded before executing a callback.
     */
    function waitForJWPlayer(callback) {
      if (typeof jwplayer === 'function') {
        callback();
      } else {
        setTimeout(() => waitForJWPlayer(callback), 100);
      }
    }

    /**
     * Sets up the server selection panel with predefined servers
     */
    function setupServerPanel() {
      const serversGrid = document.getElementById("servers-grid");
      serversGrid.innerHTML = '';
      
      predefinedServers.forEach((server, index) => {
        const button = document.createElement("div");
        button.className = "server-button";
        if (index === currentServerIndex) {
          button.classList.add("active");
        }
        
        // Create quality indicator
        let qualityClass = "quality-high";
        let qualityText = "High Quality";
        
        if (server.quality === "medium") {
          qualityClass = "quality-medium";
          qualityText = "Medium Quality";
        } else if (server.quality === "low") {
          qualityClass = "quality-low";
          qualityText = "Low Quality";
        }
        
        button.innerHTML = `
          <div class="server-icon">${server.icon}</div>
          <div>${server.name}</div>
          <div class="server-info">${server.location}</div>
          <div class="quality-indicator">
            <div class="quality-dot ${qualityClass}"></div>
            <span>${qualityText}</span>
          </div>
        `;
        
        button.onclick = () => switchToServer(index);
        serversGrid.appendChild(button);
      });
    }

    /**
     * Switches to a predefined server
     * @param {number} index - Index of the server in predefinedServers array
     */
    function switchToServer(index) {
      const server = predefinedServers[index];
      
      // Update active server button
      const serverButtons = document.querySelectorAll(".server-button");
      serverButtons.forEach((button, i) => {
        if (i === index) {
          button.classList.add("active");
        } else {
          button.classList.remove("active");
        }
      });
      
      // Setup player with new server
      waitForJWPlayer(() => {
        let streamType = '';
        if (server.url.includes('.mpd')) {
          streamType = 'dash';
        } else if (server.url.includes('.m3u8')) {
          streamType = 'hls';
        }

        const playerConfig = {
          file: server.url,
          autostart: true,
          width: "100%",
          height: "100%",
          stretching: "uniform",
        };
        
        if (streamType) {
            playerConfig.type = streamType;
        }

        // Add DRM settings only if both keyId and key are provided
        if (server.keyId && server.key) {
          playerConfig.drm = {
            clearkey: {
              keyId: server.keyId,
              key: server.key,
            },
          };
        }

        // Remove existing player if it exists
        if (currentPlayer) {
          currentPlayer.remove();
        }
        
        currentPlayer = jwplayer("player-container").setup(playerConfig);
        currentServerIndex = index;
      });
    }

    /**
     * Initialize the page - set up the server panel and auto-play the first server
     */
    function initializePage() {
      setupServerPanel();
      
      // Auto-play the first server
      if (predefinedServers.length > 0) {
        switchToServer(0);
      }
    }

    // Initialize the page when DOM is loaded
    document.addEventListener('DOMContentLoaded', initializePage);
  </script>
</body>
</html>
